{"version":3,"file":"dwvsimplistic.min.js","mappings":"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","sources":["webpack://dwv-simplistic/webpack/universalModuleDefinition","webpack://dwv-simplistic/external umd {\"root\":\"dwv\",\"commonjs\":\"dwv\",\"commonjs2\":\"dwv\",\"amd\":\"dwv\"}","webpack://dwv-simplistic/webpack/bootstrap","webpack://dwv-simplistic/webpack/runtime/define property getters","webpack://dwv-simplistic/webpack/runtime/hasOwnProperty shorthand","webpack://dwv-simplistic/webpack/runtime/make namespace object","webpack://dwv-simplistic/./src/appgui.js","webpack://dwv-simplistic/./src/gui/dropboxLoader.js","webpack://dwv-simplistic/./src/applauncher.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"dwv\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"dwv\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"dwvsimplistic\"] = factory(require(\"dwv\"));\n\telse\n\t\troot[\"dwvsimplistic\"] = factory(root[\"dwv\"]);\n})(this, (__WEBPACK_EXTERNAL_MODULE__440__) => {\nreturn ","module.exports = __WEBPACK_EXTERNAL_MODULE__440__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import {getTagFromKey} from 'dwv';\n\n// doc imports\n/* eslint-disable no-unused-vars */\nimport {App} from 'dwv';\n/* eslint-enable no-unused-vars */\n\n// icons from https://fonts.google.com/icons\n// Fill: 0 Weight: 700 Grade: 0 Optical Size: 20\n/* eslint-disable @stylistic/js/max-len */\nconst _paths = {\n  // menu\n  Scroll: 'M110-215v-118h740v118H110Zm0-206v-118h740v118H110Zm0-206v-118h740v118H110Z',\n  // search\n  ZoomAndPan: 'M763-106 517-352q-29 18-64.292 28.5T376.035-313Q267-313 190-390t-77-186q0-109 77-186t186-77q109 0 186 77t77 186.035q0 42.381-10.5 76.673T600-437l247 248-84 83ZM376-431q61 0 103-42t42-103q0-61-42-103t-103-42q-61 0-103 42t-42 103q0 61 42 103t103 42Z',\n  // contrast\n  WindowLevel: 'M480.192-62Q394-62 318-94.5q-76-32.5-133.5-90t-90-133.542Q62-394.083 62-480.542 62-567 94.5-642.5t90-133q57.5-57.5 133.542-90 76.041-32.5 162.5-32.5Q567-898 642.5-865.5t133 90q57.5 57.5 90 133.308 32.5 75.807 32.5 162Q898-394 865.5-318q-32.5 76-90 133.5t-133.308 90q-75.807 32.5-162 32.5ZM528-184q109-18 180.5-99.222T780-480q0-112.818-71.5-194.909T528-775v591Z',\n  // straighten\n  Draw: 'M183-215q-49.7 0-83.85-34.15Q65-283.3 65-333v-294q0-49.7 34.15-83.85Q133.3-745 183-745h594q49.7 0 83.85 34.15Q895-676.7 895-627v294q0 49.7-34.15 83.85Q826.7-215 777-215H183Zm0-118h594v-294H672v147h-72v-147h-84v147h-72v-147h-84v147h-72v-147H183v294Zm105-147h72-72Zm156 0h72-72Zm156 0h72-72Zm-120 0Z',\n  // refresh\n  Reset: 'M476-158q-133 0-227.5-94.5T154-480q0-133 94.5-227.5T476-802q74 0 136 30t106 82v-112h88v289H516v-87h125q-29-38-71.5-61T476-684q-85 0-144.5 59.5T272-480q0 85 59.5 144.5T476-276q78 0 134.5-52.5T677-456h121q-10 126-102 212t-220 86Z',\n  // cameraswitch\n  ToggleOrientation: 'M327-273q-35.888 0-61.444-25.556Q240-324.112 240-360v-209q0-36.3 25.15-62.15T327-657h33l48-48h144l48 48h33q36.7 0 61.85 25.85T720-569v209q0 35.888-25.556 61.444Q668.888-273 633-273H327Zm0-87h306v-209H327v209Zm153.425-40Q507-400 525.5-419.133q18.5-19.132 18.5-46Q544-492 525.075-510.5q-18.925-18.5-45.5-18.5T434.5-510.075q-18.5 18.925-18.5 45.5T434.925-419q18.925 19 45.5 19ZM336-937q35.783-11.9 73.033-17.45Q446.283-960 485-960q91 0 173.5 33.5T805-835.275q64 57.725 104.544 136.5Q950.089-620 960-528H857q-8-61-34.5-115.5t-67-97q-40.5-42.5-94-71T547-851l46 47-60 62-197-195ZM624-23q-35.783 11.9-73.033 17.45Q513.717 0 475 0q-91.92 0-174.46-33.5t-146.04-91Q91-182 49.956-261 8.91-340 0-432h103q7 61 33.5 115.5t67.5 97q41 42.5 94.5 71T413-109l-46-47 60-62L624-23ZM482-466Z',\n  // open in full\n  Fullscreen: 'M110-110v-334h118v132l420-420H516v-118h334v334H732v-132L312-228h132v118H110Z',\n  // tags\n  Tags: 'M406-405h177v-92H406v92Zm0-132h354v-92H406v92Zm0-132h354v-92H406v92Zm-51 440q-53 0-89.5-36.5T229-355v-456q0-53 36.5-89.5T355-937h456q53 0 89.5 36.5T937-811v456q0 53-36.5 89.5T811-229H355Zm0-126h456v-456H355v456ZM149-23q-53 0-89.5-36.5T23-149v-582h126v582h582v126H149Zm206-788v456-456Z'\n};\n/* eslint-enable @stylistic/js/max-len */\n\n/**\n * Get a tool html button.\n *\n * @param {string} toolName The tool name.\n * @param {object} appGui The associated GUi.\n * @returns {HTMLButtonElement} An HTML button element.\n */\nfunction getToolButton(toolName, appGui) {\n  const xmlns = 'http://www.w3.org/2000/svg';\n  const path = document.createElementNS(xmlns, 'path');\n  path.setAttributeNS(null, 'd', _paths[toolName]);\n  const svg = document.createElementNS(xmlns, 'svg');\n  svg.setAttributeNS(null, 'height', 20);\n  svg.setAttributeNS(null, 'width', 20);\n  svg.setAttributeNS(null, 'viewBox', '0 -960 960 960');\n  svg.appendChild(path);\n  const button = document.createElement('button');\n  button.id = appGui.getToolId(toolName);\n  button.title = toolName;\n  button.appendChild(svg);\n  // onclick callback\n  if (toolName === 'Reset') {\n    button.addEventListener('click', function () {\n      appGui.onDisplayReset();\n    });\n  } else if (toolName === 'ToggleOrientation') {\n    button.addEventListener('click', function () {\n      appGui.toggleOrientation();\n    });\n  } else if (toolName === 'Fullscreen') {\n    button.addEventListener('click', function () {\n      appGui.toggleFullScreen();\n    });\n  } else if (toolName === 'Tags') {\n    button.addEventListener('click', function () {\n      appGui.openTagsModal();\n    });\n  } else {\n    button.addEventListener('click', function () {\n      appGui.onChangeTool(toolName);\n    });\n  }\n  return button;\n}\n\n/**\n * Get a tool html select.\n *\n * @param {string} toolName The tool name.\n * @param {object} appGui The associated GUi.\n * @returns {HTMLSelectElement} An HTML select element.\n */\nfunction getSelect(toolName, appGui) {\n  const option = document.createElement('option');\n  option.value = '';\n  option.appendChild(document.createTextNode('Preset...'));\n  const select = document.createElement('select');\n  select.id = appGui.getToolId(toolName);\n  select.title = 'Window level presets';\n  select.appendChild(option);\n  select.addEventListener('change', function () {\n    appGui.onChangePreset(this.value);\n  });\n  return select;\n}\n\n/**\n * GUI class.\n *\n * @class\n */\nexport class Gui {\n\n  /**\n   * View this.#orientation.\n   *\n   * @type {string}\n   */\n  #orientation;\n\n  /**\n   * Layer group div height before full screen.\n   *\n   * @type {string}\n   */\n  #lgDivHeight;\n\n  /**\n   * The associated app.\n   *\n   * @type {App}\n   */\n  #app;\n\n  /**\n   * The list of tools.\n   *\n   * @type {string[]}\n   */\n  #tools;\n\n  /**\n   * The GUI UID.\n   *\n   * @type {string}\n   */\n  #uid;\n\n  /**\n   *\n   * @param {App} app The associated app.\n   * @param {string[]} tools The list of tools.\n   * @param {string} uid The GUI unique id.\n   */\n  constructor(app, tools, uid) {\n    this.#app = app;\n    this.#tools = tools;\n    this.#uid = uid;\n  };\n\n  /**\n   * Initialise the GUI: fill the toolbar.\n   */\n  init() {\n    const toolbar = document.getElementById(this.getToolbarDivId());\n    for (let i = 0; i < this.#tools.length; ++i) {\n      if (this.#tools[i] === 'WindowLevelPresets') {\n        toolbar.appendChild(getSelect(this.#tools[i], this));\n      } else {\n        toolbar.appendChild(getToolButton(this.#tools[i], this));\n      }\n    }\n  };\n\n  /**\n   * Show the progress bar: adds a progress to the\n   *   layerGroup div.\n   */\n  showProgressBar() {\n    const progress = document.createElement('progress');\n    progress.id = 'progress-' + this.#uid;\n    progress.max = '100';\n    progress.value = '0';\n\n    const lg = document.getElementById(this.getToolbarDivId());\n    lg.appendChild(progress);\n  };\n\n  /**\n   * Set the progress: updates the progress bar,\n   *   hides it if percent is 100.\n   *\n   * @param {number} percent The progess percent.\n   */\n  setProgress(percent) {\n    const progress = document.getElementById('progress-' + this.#uid);\n    if (progress) {\n      if (percent === 100) {\n        // remove\n        progress.remove();\n      } else {\n        // update value\n        progress.value = percent;\n      }\n    }\n  };\n\n  /**\n   * Get the dwv div id.\n   *\n   * @returns {string} The id.\n   */\n  getDwvDivId() {\n    return 'dwv-' + this.#uid;\n  };\n\n  /**\n   * Get the layer group div id.\n   *\n   * @returns {string} The id.\n   */\n  getLayerGroupDivId() {\n    return 'layerGroup-' + this.#uid;\n  };\n\n  /**\n   * Get the toolbar div id.\n   *\n   * @returns {string} The id.\n   */\n  getToolbarDivId() {\n    return 'toolbar-' + this.#uid;\n  };\n\n  /**\n   * Get a tool id from its name.\n   *\n   * @param {string} toolName Tool name.\n   * @returns {string} The id.\n   */\n  getToolId(toolName) {\n    return toolName.toLowerCase() + '-' + this.#uid;\n  };\n\n  /**\n   * Enable or not a tool.\n   *\n   * @param {string} name The tool name.\n   * @param {boolean} flag True to enable.\n   */\n  enableTool(name, flag) {\n    const toolId = this.getToolId(name);\n    document.getElementById(toolId).disabled = !flag;\n  };\n\n  /**\n   * Enable or not all tools.\n   *\n   * @param {boolean} flag True to enable.\n   */\n  enableTools(flag) {\n    for (let i = 0; i < this.#tools.length; ++i) {\n      this.enableTool(this.#tools[i], flag);\n    }\n  };\n\n  /**\n   * Activate or not a tool.\n   *\n   * @param {string} name The tool name.\n   * @param {boolean} flag True to activate.\n   */\n  activateTool(name, flag) {\n    const toolId = this.getToolId(name);\n    if (flag) {\n      document.getElementById(toolId).classList.add('active');\n    } else {\n      document.getElementById(toolId).classList.remove('active');\n    }\n  };\n\n  /**\n   * Activate or not all tool.\n   *\n   * @param {boolean} flag True to activate.\n   */\n  activateTools(flag) {\n    for (let i = 0; i < this.#tools.length; ++i) {\n      this.activateTool(this.#tools[i], flag);\n    }\n  };\n\n  /**\n   * Handle preset change.\n   *\n   * @param {string} name The name of the new preset.\n   */\n  onChangePreset(name) {\n    // update viewer\n    this.#app.setWindowLevelPreset(name);\n    // set selected\n    this.setSelectedPreset(name);\n  };\n\n  /**\n   * Handle tool change.\n   *\n   * @param {string} name The name of the new tool.\n   */\n  onChangeTool(name) {\n    this.activateTools(false);\n    this.activateTool(name, true);\n    this.#app.setTool(name);\n    if (name === 'Draw') {\n      this.#app.setToolFeatures({shapeName: 'Ruler'});\n    }\n  };\n\n  /**\n   * Handle display reset.\n   */\n  onDisplayReset() {\n    this.#app.resetDisplay();\n    // reset preset dropdown\n    const presetsId = this.getToolId('WindowLevelPresets');\n    const domPresets = document.getElementById(presetsId);\n    domPresets.selectedIndex = 0;\n  };\n\n  /**\n   * Toggle the viewer this.#orientation.\n   */\n  toggleOrientation() {\n    if (typeof this.#orientation !== 'undefined') {\n      if (this.#orientation === 'axial') {\n        this.#orientation = 'coronal';\n      } else if (this.#orientation === 'coronal') {\n        this.#orientation = 'sagittal';\n      } else if (this.#orientation === 'sagittal') {\n        this.#orientation = 'axial';\n      }\n    } else {\n      // default is most probably axial\n      this.#orientation = 'coronal';\n    }\n    // update data view config\n    const config = {\n      '*': [\n        {\n          divId: this.getLayerGroupDivId(),\n          orientation: this.#orientation\n        }\n      ]\n    };\n    this.#app.setDataViewConfigs(config);\n    // render data\n    const dataIds = this.#app.getDataIds();\n    for (let i = 0; i < dataIds.length; ++i) {\n      this.#app.render(dataIds[i]);\n    }\n  };\n\n  /**\n   * Toogle full screen on and off.\n   */\n  toggleFullScreen() {\n    const lgDivId = this.getLayerGroupDivId();\n    const lgElement = document.getElementById(lgDivId);\n\n    // the app listens on window resize (see applaucher\n    // `window.addEventListener('resize', dwvApp.onResize);`)\n    // -> no need to manually call app.fitToContainer\n\n    if (!document.fullscreenElement) {\n      const fsDivId = this.getDwvDivId();\n      const fsElement = document.getElementById(fsDivId);\n      fsElement.requestFullscreen().then(() => {\n        // if the layer group height was 0, the app set it to a fixed size.\n        // change it to 100% to trigger a resize and recalculate the\n        // fit scale to occupy the full screen\n        this.#lgDivHeight = lgElement.style.height;\n        lgElement.style.height = '100%';\n      });\n    } else if (document.exitFullscreen) {\n      document.exitFullscreen();\n      // restore previous height\n      lgElement.style.height = this.#lgDivHeight;\n    }\n  };\n\n  /**\n   * Open a DICOM tags modal.\n   */\n  openTagsModal() {\n    // modal\n    const modalDiv = document.createElement('div');\n    modalDiv.className = 'modal';\n    modalDiv.id = 'modal-' + this.#uid;\n    modalDiv.style.display = 'block';\n    // close on outside click\n    window.addEventListener('click', function (event) {\n      if (event.target === modalDiv) {\n        modalDiv.style.display = 'none';\n      }\n    });\n\n    const modalContentDiv = document.createElement('div');\n    modalContentDiv.className = 'modal-content';\n    modalContentDiv.id = 'modal-content-' + this.#uid;\n    modalDiv.appendChild(modalContentDiv);\n\n    const modalTitle = document.createElement('h2');\n    modalTitle.appendChild(document.createTextNode('DICOM Tags'));\n    modalContentDiv.appendChild(modalTitle);\n\n    // div with enabled scroll\n    const modalScrollDiv = document.createElement('div');\n    modalScrollDiv.className = 'modal-content-scroll';\n\n    const metaData = this.#app.getMetaData('0');\n\n    // InstanceNumber\n    const instanceElement = metaData['00200013'];\n    let instanceNumbers;\n    if (typeof instanceElement !== 'undefined') {\n      // set slider with instance numbers ('00200013')\n      let instanceNumberValue = instanceElement.value;\n      if (typeof instanceNumberValue === 'string') {\n        instanceNumberValue = [instanceNumberValue];\n      }\n      // convert string to numbers\n      instanceNumbers = instanceNumberValue.map(Number);\n      // sort\n      instanceNumbers.sort(function (a, b) {\n        return a - b;\n      });\n    }\n\n    let instanceNumber = instanceNumbers[0];\n\n    const slider = document.createElement('input');\n    slider.type = 'range';\n    slider.id = 'instancenumber-slider-' + this.#uid;\n    slider.min = 0;\n    slider.max = instanceNumbers.length - 1;\n    slider.value = 0;\n    slider.title = 'Instance Number';\n    const sliderLabel = document.createElement('label');\n    sliderLabel.id = 'instancenumber-slider-label-' + this.#uid;\n    sliderLabel.for = slider.id;\n    sliderLabel.appendChild(document.createTextNode(instanceNumber));\n    sliderLabel.title = slider.title;\n\n    const sliderLine = document.createElement('p');\n    sliderLine.appendChild(slider);\n    sliderLine.appendChild(sliderLabel);\n    modalContentDiv.appendChild(sliderLine);\n\n    slider.addEventListener('input', function (event) {\n      instanceNumber = instanceNumbers[event.target.value];\n      const metaArr = getMetaArray(metaData, instanceNumber);\n      const metaTab = arrayToHtmlTable(metaArr);\n      modalScrollDiv.replaceChildren(metaTab);\n      sliderLabel.replaceChildren(document.createTextNode(instanceNumber));\n    });\n\n    // get meta data html table\n    const metaArray = getMetaArray(metaData, instanceNumber);\n    const metaTable = arrayToHtmlTable(metaArray);\n    modalScrollDiv.appendChild(metaTable);\n    modalContentDiv.appendChild(modalScrollDiv);\n\n    // global container\n    const container = document.getElementById(this.getDwvDivId());\n    container.appendChild(modalDiv);\n  };\n\n  /**\n   * Update preset dropdown.\n   *\n   * @param {Array} presets The list of presets to use as options.\n   */\n  updatePresets(presets) {\n    const presetsId = this.getToolId('WindowLevelPresets');\n    const domPresets = document.getElementById(presetsId);\n    // clear previous\n    while (domPresets.hasChildNodes()) {\n      domPresets.removeChild(domPresets.firstChild);\n    }\n    // add new\n    for (let i = 0; i < presets.length; ++i) {\n      const option = document.createElement('option');\n      option.value = presets[i];\n      const label = presets[i];\n      option.appendChild(document.createTextNode(label));\n      domPresets.appendChild(option);\n    }\n  };\n\n  /**\n   * Set the selected preset in the preset dropdown.\n   *\n   * @param {string} name The name of the preset to select.\n   */\n  setSelectedPreset(name) {\n    const presetsId = this.getToolId('WindowLevelPresets');\n    const domPresets = document.getElementById(presetsId);\n    // find the index\n    let index = 0;\n    for (index in domPresets.options) {\n      if (domPresets.options[index].value === name) {\n        break;\n      }\n    }\n    // set selected\n    domPresets.selectedIndex = index;\n  };\n\n}; // class dwvsimple.Gui\n\n\n/**\n * Get an HTML table from a string array.\n *\n * @param {string[]} arr The input array.\n * @returns {HTMLTableElement} The HTML table element.\n */\nfunction arrayToHtmlTable(arr) {\n  const table = document.createElement('table');\n  let row;\n  let cell;\n\n  // check input\n  if (typeof arr === 'undefined' ||\n    arr.length === 0) {\n    row = table.insertRow(-1);\n    cell = document.createElement('td');\n    cell.appendChild(document.createTextNode('Empty input array...'));\n    row.appendChild(cell);\n    return table;\n  }\n\n  // extract keys from first element\n  const item0 = arr[0];\n  const keys = Object.keys(item0);\n\n  // table body\n  for (let i = 0; i < arr.length; ++i) {\n    row = table.insertRow(-1);\n    for (let j = 0; j < keys.length; ++j) {\n      cell = document.createElement('td');\n      cell.appendChild(document.createTextNode(arr[i][keys[j]]));\n      row.appendChild(cell);\n    }\n  }\n  // table head\n  const thead = table.createTHead();\n  const th = thead.insertRow(-1);\n  for (let k = 0; k < keys.length; ++k) {\n    const hcell = document.createElement('th');\n    let key = keys[k];\n    key = key.charAt(0).toUpperCase() + key.slice(1);\n    hcell.appendChild(document.createTextNode(key));\n    th.appendChild(hcell);\n  }\n\n  return table;\n}\n\n/**\n * Get the meta data as an array.\n *\n * @param {any} meta The meta data.\n * @param {number} instanceNumber The instance number.\n * @returns {string[]} The meta data as a flat string array.\n */\nfunction getMetaArray(meta, instanceNumber) {\n  let reducer;\n  if (isDicomMeta(meta)) {\n    reducer = getDicomTagReducer(meta, instanceNumber, '');\n  } else {\n    reducer = getTagReducer(meta);\n  }\n  const keys = Object.keys(meta);\n  return keys.reduce(reducer, []);\n}\n\n/**\n * Check if a meta data is a dicom one.\n *\n * @param {any} meta The dicom meta data.\n * @returns {boolean} True if the meta data is a DICOM one.\n */\nfunction isDicomMeta(meta) {\n  // true if it has a Transfer Syntax\n  return typeof meta['00020010'] !== 'undefined';\n}\n\n/**\n * Get a simple data array reducer.\n *\n * @param {any} tagData Simple data with a 'value' property.\n * @returns {Function} The data recuder.\n */\nfunction getTagReducer(tagData) {\n  return function (accumulator, currentValue) {\n    accumulator.push({\n      name: currentValue,\n      value: tagData[currentValue].value\n    });\n    return accumulator;\n  };\n}\n\n/**\n * Get a DICOM data array reducer.\n *\n * @param {any} tagData DICOM data.\n * @param {number} instanceNumber The instance number.\n * @param {string} prefix The prefix.\n * @returns {Function} The data reducer.\n */\nfunction getDicomTagReducer(tagData, instanceNumber, prefix) {\n  return function (accumulator, currentValue) {\n    const tag = getTagFromKey(currentValue);\n    let key = tag.getNameFromDictionary();\n    if (typeof key === 'undefined') {\n      // add 'x' to help sorting\n      key = 'x' + tag.getKey();\n    }\n    const name = key;\n    const element = tagData[currentValue];\n    let value = element.value;\n    // possible 'merged' object\n    // (use slice method as test for array and typed array)\n    if (typeof value.slice === 'undefined' &&\n      typeof value[instanceNumber] !== 'undefined') {\n      value = value[instanceNumber];\n    }\n    // force instance number (otherwise takes value in non indexed array)\n    if (name === 'InstanceNumber') {\n      value = instanceNumber;\n    }\n    // recurse for sequence\n    if (element.vr === 'SQ') {\n      // sequence tag\n      accumulator.push({\n        name: (prefix ? prefix + ' ' : '') + name,\n        value: ''\n      });\n      // sequence value\n      for (let i = 0; i < value.length; ++i) {\n        const sqItems = value[i];\n        const keys = Object.keys(sqItems);\n        const res = keys.reduce(\n          getDicomTagReducer(\n            sqItems, instanceNumber, prefix + '[' + i + ']'), []\n        );\n        accumulator = accumulator.concat(res);\n      }\n    } else {\n      // shorten long 'o'ther data\n      if (element.vr[0] === 'O' && value.length > 10) {\n        value = value.slice(0, 10).toString() +\n          '... (len:' + value.length + ')';\n      }\n      accumulator.push({\n        name: (prefix ? prefix + ' ' : '') + name,\n        value: value.toString()\n      });\n    }\n    return accumulator;\n  };\n}\n","// doc imports\n/* eslint-disable no-unused-vars */\nimport {App} from 'dwv';\n/* eslint-enable no-unused-vars */\n\n/**\n * Dropbox loader.\n * Listens to drag events on the layer container and\n *   uses a drop box element as first display.\n *\n * @class\n */\nexport class DropboxLoader {\n\n  /**\n   * The associated app.\n   *\n   * @type {App}\n   */\n  #app;\n\n  /**\n   * The GUI UID.\n   *\n   * @type {string}\n   */\n  #uid;\n\n  // drop box class name\n  #dropboxDivId = 'dropBox';\n  #dropboxClassName = 'dropBox';\n  #borderClassName = 'dropBoxBorder';\n  #hoverClassName = 'hover';\n\n  /**\n   * @param {App} app The associated application.\n   * @param {string} uid The GUI UID.\n   */\n  constructor(app, uid) {\n    this.#app = app;\n    this.#uid = uid;\n  }\n\n  /**\n   * Initialise the drop box.\n   */\n  init() {\n    this.showDropbox(true);\n  };\n\n  /**\n   * Basic handle drag event.\n   *\n   * @private\n   * @param {object} event The event to handle.\n   */\n  #defaultHandleDragEvent = (event) => {\n    // prevent default handling\n    event.stopPropagation();\n    event.preventDefault();\n  };\n\n  /**\n   * Handle a drag over.\n   *\n   * @private\n   * @param {object} event The event to handle.\n   */\n  #onBoxDragOver = (event) => {\n    this.#defaultHandleDragEvent(event);\n    // update box border\n    const box = document.getElementById(this.#dropboxDivId);\n    if (box && box.className.indexOf(this.#hoverClassName) === -1) {\n      box.className += ' ' + this.#hoverClassName;\n    }\n  };\n\n  /**\n   * Handle a drag leave.\n   *\n   * @private\n   * @param {object} event The event to handle.\n   */\n  #onBoxDragLeave = (event) => {\n    this.#defaultHandleDragEvent(event);\n    // update box border\n    const box = document.getElementById(this.#dropboxDivId);\n    if (box && box.className.indexOf(this.#hoverClassName) !== -1) {\n      box.className = box.className.replace(' ' + this.#hoverClassName, '');\n    }\n  };\n\n  /**\n   * Handle a drop event.\n   *\n   * @private\n   * @param {object} event The event to handle.\n   */\n  #onDrop = (event) => {\n    this.#defaultHandleDragEvent(event);\n    // load files\n    this.#app.loadFiles(event.dataTransfer.files);\n  };\n\n  /**\n   * Handle a an input[type:file] change event.\n   *\n   * @param {object} event The event to handle.\n   */\n  #onInputFile = (event) => {\n    if (event.target && event.target.files) {\n      this.#app.loadFiles(event.target.files);\n    }\n  };\n\n  /**\n   * Show or hide the data load drop box.\n   *\n   * @param {boolean} show Flag to show or hide.\n   */\n  showDropbox(show) {\n    const box = document.getElementById(this.#dropboxDivId);\n    if (!box) {\n      return;\n    }\n    const layerDiv = document.getElementById('layerGroup-' + this.#uid);\n\n    if (show) {\n      // reset css class\n      box.className = this.#dropboxClassName + ' ' + this.#borderClassName;\n      // add content if empty\n      if (box.innerHTML === '') {\n        const p = document.createElement('p');\n        p.appendChild(document.createTextNode('Drag and drop data here or '));\n        // input file\n        const input = document.createElement('input');\n        input.onchange = this.#onInputFile;\n        input.type = 'file';\n        input.multiple = true;\n        input.id = 'input-file';\n        input.style.display = 'none';\n        const label = document.createElement('label');\n        label.htmlFor = 'input-file';\n        const link = document.createElement('a');\n        link.appendChild(document.createTextNode('click here'));\n        link.id = 'input-file-link';\n        label.appendChild(link);\n        p.appendChild(input);\n        p.appendChild(label);\n\n        box.appendChild(p);\n      }\n      // show box\n      box.setAttribute('style', 'display:initial');\n      // stop layer listening\n      if (layerDiv) {\n        layerDiv.removeEventListener('dragover', this.#defaultHandleDragEvent);\n        layerDiv.removeEventListener('dragleave', this.#defaultHandleDragEvent);\n        layerDiv.removeEventListener('drop', this.#onDrop);\n      }\n      // listen to box events\n      box.addEventListener('dragover', this.#onBoxDragOver);\n      box.addEventListener('dragleave', this.#onBoxDragLeave);\n      box.addEventListener('drop', this.#onDrop);\n    } else {\n      // remove border css class\n      box.className = this.#dropboxClassName;\n      // remove content\n      box.innerHTML = '';\n      // hide box\n      box.setAttribute('style', 'display:none');\n      // stop box listening\n      box.removeEventListener('dragover', this.#onBoxDragOver);\n      box.removeEventListener('dragleave', this.#onBoxDragLeave);\n      box.removeEventListener('drop', this.#onDrop);\n      // listen to layer events\n      if (layerDiv) {\n        layerDiv.addEventListener('dragover', this.#defaultHandleDragEvent);\n        layerDiv.addEventListener('dragleave', this.#defaultHandleDragEvent);\n        layerDiv.addEventListener('drop', this.#onDrop);\n      }\n    }\n  };\n}; // DropboxLoader\n","import {\n  App,\n  WindowCenterAndWidth\n} from 'dwv';\n\nimport {Gui} from './appgui';\nimport {DropboxLoader} from './gui/dropboxLoader';\n\n/**\n * Application launcher.\n *\n * @param {string} uid The app uid.\n * @param {object} [options] Start options:\n * - urls (string[]): list of urls to load,\n * - wlpreset (object): default window level preset.\n */\nexport function startApp(uid, options) {\n  // app options\n  const appOptions = {\n    dataViewConfigs: {'*': [{divId: 'layerGroup-' + uid}]},\n    tools: {\n      Scroll: {},\n      ZoomAndPan: {},\n      WindowLevel: {},\n      Draw: {\n        options: ['Ruler']\n      }\n    }\n  };\n  // main application\n  const dwvApp = new App();\n  dwvApp.init(appOptions);\n\n  // app gui\n  const guiTools = Object.keys(appOptions.tools);\n  const wlIndex = guiTools.indexOf('WindowLevel');\n  if (wlIndex !== -1) {\n    guiTools.splice(wlIndex + 1, 0, 'WindowLevelPresets');\n  }\n  guiTools.push('Reset');\n  guiTools.push('ToggleOrientation');\n  guiTools.push('Fullscreen');\n  guiTools.push('Tags');\n  const dwvAppGui = new Gui(dwvApp, guiTools, uid);\n  dwvAppGui.init();\n  dwvAppGui.enableTools(false);\n\n  // abort shortcut listener\n  const abortOnCrtlX = function (event) {\n    if (event.ctrlKey && event.keyCode === 88) {\n      // crtl-x\n      console.log('Abort load received from user (crtl-x).');\n      dwvApp.abortLoad();\n    }\n  };\n\n  // handle load events\n  let nLoadItem;\n  let nReceivedLoadError;\n  let nReceivedLoadAbort;\n  let isFirstRender;\n  dwvApp.addEventListener('loadstart', function (/*event*/) {\n    // reset counts\n    nLoadItem = 0;\n    nReceivedLoadError = 0;\n    nReceivedLoadAbort = 0;\n    isFirstRender = true;\n    // allow to cancel via crtl-x\n    window.addEventListener('keydown', abortOnCrtlX);\n    // show progress bar\n    dwvAppGui.showProgressBar();\n  });\n  dwvApp.addEventListener('loadprogress', function (event) {\n    const percent = Math.ceil(event.loaded * 100 / event.total);\n    // set progress (hides the bar is percent=100)\n    dwvAppGui.setProgress(percent);\n  });\n  dwvApp.addEventListener('load', function (/*event*/) {\n    // force hidding in case 100% progress was not sent\n    dwvAppGui.setProgress(100);\n  });\n  dwvApp.addEventListener('loaditem', function (/*event*/) {\n    ++nLoadItem;\n  });\n  dwvApp.addEventListener('renderend', function (/*event*/) {\n    if (isFirstRender) {\n      isFirstRender = false;\n      // enable tools\n      dwvAppGui.enableTools(true);\n      // set the selected tool\n      let selectedTool = 'ZoomAndPan';\n      if (dwvApp.canScroll()) {\n        selectedTool = 'Scroll';\n      } else {\n        dwvAppGui.enableTool('Scroll', false);\n      }\n      if (!dwvApp.canWindowLevel()) {\n        dwvAppGui.enableTool('WindowLevel', false);\n      }\n      dwvApp.setTool(selectedTool);\n      dwvAppGui.activateTool(selectedTool, true);\n      // update presets\n      const lg = dwvApp.getActiveLayerGroup();\n      const vl = lg.getActiveViewLayer();\n      const viewController = vl.getViewController();\n      // optional wl preset\n      let hasExtraPreset = false;\n      let wlpreset;\n      if (typeof options !== 'undefined' &&\n        typeof options.wlpreset !== 'undefined') {\n        hasExtraPreset = true;\n        wlpreset = options.wlpreset;\n        const presets = {};\n        presets[wlpreset.name] = {\n          wl: [new WindowCenterAndWidth(wlpreset.center, wlpreset.width)],\n          name: wlpreset.name\n        };\n        viewController.addWindowLevelPresets(presets);\n      }\n      // update GUI\n      dwvAppGui.updatePresets(\n        viewController.getWindowLevelPresetsNames()\n      );\n      // select optional preset\n      if (hasExtraPreset) {\n        viewController.setWindowLevelPreset(wlpreset.name);\n        dwvAppGui.setSelectedPreset(options.wlpreset.name);\n      }\n    }\n  });\n  dwvApp.addEventListener('error', function (event) {\n    console.error(event.error);\n    ++nReceivedLoadError;\n  });\n  dwvApp.addEventListener('abort', function (/*event*/) {\n    ++nReceivedLoadAbort;\n  });\n  dwvApp.addEventListener('loadend', function (/*event*/) {\n    // show alert for errors\n    if (nReceivedLoadError) {\n      let message = 'A load error has ';\n      if (nReceivedLoadError > 1) {\n        message = nReceivedLoadError + ' load errors have ';\n      }\n      message += 'occured. See log for details.';\n      alert(message);\n    }\n    // console warn for aborts\n    if (nReceivedLoadAbort !== 0) {\n      console.warn('Data load was aborted.');\n    }\n    // stop listening for crtl-x\n    window.removeEventListener('keydown', abortOnCrtlX);\n  });\n\n  // setup drop box\n  const dropBoxLoader = new DropboxLoader(dwvApp, uid);\n  dropBoxLoader.init();\n  // show/hide drop box\n  dwvApp.addEventListener('loadstart', function (/*event*/) {\n    // hide drop box\n    dropBoxLoader.showDropbox(false);\n  });\n  dwvApp.addEventListener('loadend', function (/*event*/) {\n    // show the drop box if no item were received or\n    // if the load was aborted\n    if (!nLoadItem ||\n      nReceivedLoadAbort !== 0) {\n      dropBoxLoader.showDropbox(true);\n    }\n  });\n\n  // handle key events\n  dwvApp.addEventListener('keydown', function (event) {\n    dwvApp.defaultOnKeydown(event);\n  });\n  // handle window resize\n  window.addEventListener('resize', dwvApp.onResize);\n\n  // listen to 'wlchange'\n  dwvApp.addEventListener('wlchange', function (/*event*/) {\n    // update presets (in case new was added)\n    const lg = dwvApp.getActiveLayerGroup();\n    const vl = lg.getActiveViewLayer();\n    const viewController = vl.getViewController();\n    dwvAppGui.updatePresets(\n      viewController.getWindowLevelPresetsNames()\n    );\n    // suppose it is a manual change so switch preset to manual\n    dwvAppGui.setSelectedPreset('manual');\n  });\n\n  // load from options.urls if defined\n  if (typeof options !== 'undefined' &&\n    typeof options.urls !== 'undefined') {\n    dwvApp.loadURLs(options.urls);\n  } else {\n    // possible load from location\n    dwvApp.loadFromUri(window.location.href);\n  }\n};\n"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE__440__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","_paths","Scroll","ZoomAndPan","WindowLevel","Draw","Reset","ToggleOrientation","Fullscreen","Tags","getToolButton","toolName","appGui","xmlns","path","document","createElementNS","setAttributeNS","svg","appendChild","button","createElement","id","getToolId","title","addEventListener","onDisplayReset","toggleOrientation","toggleFullScreen","openTagsModal","onChangeTool","getSelect","option","createTextNode","select","onChangePreset","_orientation","WeakMap","_lgDivHeight","_app","_tools","_uid","Gui","app","tools","uid","_classCallCheck","_classPrivateFieldInitSpec","_classPrivateFieldSet","toolbar","getElementById","getToolbarDivId","i","_classPrivateFieldGet","length","progress","max","percent","remove","toLowerCase","name","flag","toolId","disabled","enableTool","classList","add","activateTool","setWindowLevelPreset","setSelectedPreset","activateTools","setTool","setToolFeatures","shapeName","resetDisplay","presetsId","selectedIndex","config","divId","getLayerGroupDivId","orientation","setDataViewConfigs","dataIds","getDataIds","render","_this","lgDivId","lgElement","fullscreenElement","exitFullscreen","style","height","fsDivId","getDwvDivId","requestFullscreen","then","modalDiv","className","display","window","event","target","modalContentDiv","modalTitle","modalScrollDiv","instanceNumbers","metaData","getMetaData","instanceElement","instanceNumberValue","map","Number","sort","a","b","instanceNumber","slider","type","min","sliderLabel","sliderLine","metaTab","arrayToHtmlTable","getMetaArray","replaceChildren","metaTable","presets","domPresets","hasChildNodes","removeChild","firstChild","label","index","options","arr","row","cell","table","insertRow","item0","keys","j","th","createTHead","k","hcell","charAt","toUpperCase","slice","meta","reducer","tagData","isDicomMeta","getDicomTagReducer","accumulator","currentValue","push","reduce","prefix","tag","getTagFromKey","getNameFromDictionary","getKey","element","vr","sqItems","res","concat","toString","_dropboxDivId","_dropboxClassName","_borderClassName","_hoverClassName","_defaultHandleDragEvent","_onBoxDragOver","_onBoxDragLeave","_onDrop","_onInputFile","DropboxLoader","stopPropagation","preventDefault","box","indexOf","replace","loadFiles","dataTransfer","files","showDropbox","show","layerDiv","innerHTML","p","input","onchange","multiple","htmlFor","link","setAttribute","removeEventListener","startApp","appOptions","dataViewConfigs","dwvApp","App","init","guiTools","wlIndex","splice","dwvAppGui","enableTools","nLoadItem","nReceivedLoadError","nReceivedLoadAbort","isFirstRender","abortOnCrtlX","ctrlKey","keyCode","console","log","abortLoad","showProgressBar","Math","ceil","loaded","total","setProgress","selectedTool","canScroll","canWindowLevel","wlpreset","viewController","getActiveLayerGroup","getActiveViewLayer","getViewController","hasExtraPreset","wl","WindowCenterAndWidth","center","width","addWindowLevelPresets","updatePresets","getWindowLevelPresetsNames","error","message","alert","warn","dropBoxLoader","defaultOnKeydown","onResize","urls","loadURLs","loadFromUri","location","href"],"sourceRoot":""}